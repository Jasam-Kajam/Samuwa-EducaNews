<!DOCTYPE html>
<html>
<head>
  <title>Admin Panel</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
</head>
<body>
  <h2>Admin Panel</h2>

  <!-- Login Section -->
  <div id="login-section">
    <input type="email" id="adminEmail" placeholder="Email"><br>
    <input type="password" id="adminPassword" placeholder="Password"><br>
    <button id="loginBtn">Login</button>
    <p id="loginStatus"></p>
  </div>

  <!-- Upload Section -->
  <div id="upload-section" style="display: none;">
    <input type="text" id="title" placeholder="Title"><br>
    <input type="text" id="category" placeholder="Category"><br>
    <input type="file" id="file"><br>
<textarea id="article" placeholder="Write article content here..." rows="1000"></textarea>
<input type="file" id="file" />
<button id="uploadBtn">Upload</button>
<p id="uploadStatus"></p>
  </div>

  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyAwAxP-MWwNnKP59PA6joil4Ceq10eozlc",
      authDomain: "wafula-s-educational-posts.firebaseapp.com",
      projectId: "wafula-s-educational-posts",
      storageBucket: "wafula-s-educational-posts.appspot.com",
      messagingSenderId: "1040710248503",
      appId: "1:1040710248503:web:87fbd02de2b919511577b2"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

    document.addEventListener("DOMContentLoaded", function () {
      const loginBtn = document.getElementById("loginBtn");
      const uploadSection = document.getElementById("upload-section");
      const loginStatus = document.getElementById("loginStatus");

      loginBtn.addEventListener("click", () => {
        const email = document.getElementById("adminEmail").value;
        const password = document.getElementById("adminPassword").value;

        loginStatus.textContent = "Logging in...";

        firebase.auth().signInWithEmailAndPassword(email, password)
          .then((userCredential) => {
            loginStatus.textContent = "Login successful!";
            document.getElementById("login-section").style.display = "none";
            uploadSection.style.display = "block";
          })
          .catch((error) => {
            console.error(error);
            loginStatus.textContent = "Login failed: " + error.message;
          });
      });

      const uploadBtn = document.getElementById("uploadBtn");
      const uploadStatus = document.getElementById("uploadStatus");

      uploadBtn.addEventListener("click", async () => {
        const title = document.getElementById("title").value;
        const category = document.getElementById("category").value;
        const fileInput = document.getElementById("file");
        const file = fileInput.files[0];

        if (!title || !category || !file) {
          uploadStatus.textContent = "Please fill all fields.";
          return;
        }

        uploadStatus.textContent = "Uploading...";

        try {
          const storageRef = firebase.storage().ref(`uploads/${file.name}`);
          await storageRef.put(file);
          const fileURL = await storageRef.getDownloadURL();

          await firebase.firestore().collection("posts").add({
            title,
            category,
            url: fileURL,
            timestamp: firebase.firestore.FieldValue.serverTimestamp(),
          });

          uploadStatus.textContent = "Upload successful!";
          fileInput.value = "";
        } catch (err) {
          console.error(err);
          uploadStatus.textContent = "Upload failed: " + err.message;
        }
      });
    });
  </script>
</body>
</html>