<!DOCTYPE html>  <html>  
<head>  
  <title>Admin Panel</title>  
  <style>  
    body { font-family: Arial; padding: 20px; max-width: 800px; margin: auto; }  
    .hidden { display: none; }  
    .card { border: 1px solid #ccc; padding: 10px; margin: 10px 0; border-radius: 8px; }  
    iframe, img, video { max-width: 100%; margin-top: 10px; }  
    textarea { width: 100%; height: 100px; }  
  </style>  
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>  
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>  
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-storage-compat.js"></script>  
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>  
<!-- Quill Editor CDN -->
<link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.7/quill.js"></script>
</head>  
<body>  
  <h1>Admin Panel</h1>    <!-- LOGIN SECTION -->    <div id="login-section">  
    <input type="email" id="adminEmail" placeholder="Admin Email"><br><br>  
    <input type="password" id="adminPassword" placeholder="Password"><br><br>  
    <button id="loginBtn">Login</button>  
    <p id="loginStatus"></p>  
  </div>    <!-- UPLOAD SECTION -->    <div id="upload-section" class="hidden">  
    <h2>Upload New Post</h2>  
    <input type="text" id="title" placeholder="Title"><br><br>  
    <select id="category">  
      <option value="">Select Category</option>  
      <option value="PDF">PDF</option>  
      <option value="Video">Video</option>  
      <option value="Image">Image</option>  
      <option value="Article">Article</option>  
    </select><br><br>  
    <input type="file" id="file"><br><br>  
    <div id="editor" style="height: 200px;"></div><br><br>  
    <button id="uploadBtn">Upload</button>  
    <p id="uploadStatus"></p>  <hr>  
<h2>Uploaded Posts</h2>  
<label for="categoryFilter">Filter by Category:</label>  
<select id="categoryFilter">  
  <option value="all">All</option>  
  <option value="PDF">PDF</option>  
  <option value="Video">Video</option>  
  <option value="Image">Image</option>  
  <option value="Article">Article</option>  
</select>  
<input type="text" id="searchTitle" placeholder="Search by title..." style="margin-left: 10px;">  
<div id="contentArea"></div>

  </div>    <script>  
    // Your Firebase config here  
    const firebaseConfig = {  
      apiKey: "AIzaSyAwAxP-MWwNnKP59PA6joil4Ceq10eozlc",  
      authDomain: "wafula-s-educational-posts.firebaseapp.com",  
      projectId: "wafula-s-educational-posts",  
      storageBucket: "wafula-s-educational-posts.appspot.com",  
      messagingSenderId: "your-id",  
      appId: "your-id"  
    };  
  
    firebase.initializeApp(firebaseConfig);  
    const db = firebase.firestore();  
    const storage = firebase.storage();  
  
    const loginBtn = document.getElementById("loginBtn");  
    const uploadBtn = document.getElementById("uploadBtn");  
    const uploadSection = document.getElementById("upload-section");  
    const loginStatus = document.getElementById("loginStatus");  
    const uploadStatus = document.getElementById("uploadStatus");  
  
    loginBtn.addEventListener("click", () => {  
      const email = document.getElementById("adminEmail").value;  
      const password = document.getElementById("adminPassword").value;  
      loginStatus.textContent = "Logging in...";  
  
      firebase.auth().signInWithEmailAndPassword(email, password)  
        .then(() => {  
          loginStatus.textContent = "Login successful!";  
          document.getElementById("login-section").style.display = "none";  
          uploadSection.classList.remove("hidden");  
          loadPosts();  
        })  
        .catch((err) => {  
          loginStatus.textContent = "Login failed: " + err.message;  
        });  
    });  
  
    uploadBtn.addEventListener("click", async () => {  
      const title = document.getElementById("title").value;  
      const category = document.getElementById("category").value;  
      const fileInput = document.getElementById("file");  
      const file = fileInput.files[0];  
      const articleText = quill.root.innerHTML.trim(); 
  
      if (!title || !category || (category !== "Article" && !file && !articleText)) {  
        uploadStatus.textContent = "Fill all required fields.";  
        return;  
      }  
  
      uploadStatus.textContent = "Uploading...";  
  
      try {  
        let fileURL = "";  
        if (file) {  
          const storageRef = storage.ref(`uploads/${Date.now()}_${file.name}`);  
          await storageRef.put(file);  
          fileURL = await storageRef.getDownloadURL();  
        }  
  
        await db.collection("posts").add({  
          title,  
          category,  
          url: fileURL,  
          article: category === "Article" ? articleText : "",  
          timestamp: firebase.firestore.FieldValue.serverTimestamp()  
        });  
  
        uploadStatus.textContent = "Upload successful!";  
        fileInput.value = "";  
        document.getElementById("title").value = "";  
        document.getElementById("articleText").value = "";  
        document.getElementById("category").value = "";  
        loadPosts();  
      } catch (err) {  
        console.error(err);  
        uploadStatus.textContent = "Upload failed: " + err.message;  
      }  
    });  
  
    function loadPosts() {  
      const contentArea = document.getElementById("contentArea");  
      const selectedCategory = document.getElementById("categoryFilter").value.toLowerCase();  
      const searchTitle = document.getElementById("searchTitle").value.toLowerCase();  
  
      contentArea.innerHTML = "<p>Loading...</p>";  
  
      db.collection("posts").orderBy("timestamp", "desc").get()  
        .then(snapshot => {  
          contentArea.innerHTML = "";  
          snapshot.forEach(doc => {  
            const post = doc.data();  
            const titleMatch = post.title.toLowerCase().includes(searchTitle);  
            const categoryMatch = selectedCategory === "all" || post.category.toLowerCase() === selectedCategory;  
  
            if (titleMatch && categoryMatch) {  
              const div = document.createElement("div");  
              div.className = "card";  
  
              let html = `<h3>${post.title}</h3><p><strong>Category:</strong> ${post.category}</p>`;  
              if (post.article) html += `<p>${post.article}</p>`;  
              if (post.url) {  
                const ext = post.url.split('.').pop().split('?')[0].toLowerCase();  
                if (ext === "pdf") {  
                  html += `<iframe src="${post.url}" height="400"></iframe>`;  
                } else if (["jpg", "jpeg", "png", "gif"].includes(ext)) {  
                  html += `<img src="${post.url}" alt="Image">`;  
                } else if (["mp4", "webm"].includes(ext)) {  
                  html += `<video controls><source src="${post.url}" type="video/${ext}"></video>`;  
                } else {  
                  html += `<a href="${post.url}" target="_blank">Download File</a>`;  
                }  
              }  
  
              div.innerHTML = html;  
              contentArea.appendChild(div);  
            }  
          });  
  
          if (contentArea.innerHTML === "") {  
            contentArea.innerHTML = "<p>No posts found.</p>";  
          }  
        });  
    }  
  
    document.getElementById("categoryFilter").addEventListener("change", loadPosts);  
    document.getElementById("searchTitle").addEventListener("input", loadPosts);  

const quill = new Quill('#editor', {
  theme: 'snow',
  placeholder: 'Write article content here (for articles only)',
  modules: {
    toolbar: [
      [{ header: [1, 2, 3, false] }],
      ['bold', 'italic', 'underline', 'strike'],
      [{ list: 'ordered' }, { list: 'bullet' }],
      ['blockquote', 'code-block'],
      ['link', 'image', 'video'],
      ['clean']
    ]
  }
});
  </script>  </body>  
</html>